<!--#nk_get NewVpnG2G=""-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="Pragma" content="No-Cache">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Web Management</title>
<link type="text/css" rel="stylesheet" href="nk.css">
<!--#nk_get JavaScript="nk:0"--><script src="nk.js"></script><!--#nk_get JavaScript="nk:1"-->
<!--#nk_get JavaScript="lg:0"--><script src="lg.js"></script><!--#nk_get JavaScript="lg:1"-->
<script  language="JavaScript">
/***************************************************/
/*												     */	
/*      		Begin of content's JavaScript function    	    */
/*												    */	
/***************************************************/
function Entryfunction()
{
	if (GetURLParam() == "11")
		document.getElementById("Local Group Setup").scrollIntoView(true);
	else if (GetURLParam() == "12")
		document.getElementById("Remote Group Setup").scrollIntoView(true);
	else if (GetURLParam() == "13")
		document.getElementById("IPSec Setup").scrollIntoView(true);
	else if (GetURLParam() == "14")
		document.getElementById("Advanced").scrollIntoView(true);
	chAfterSubmit();
	chLGaT();	
	checkKeySize('0'); 
	checkMaxNumber();
	<!--#nk_get VpnG2Gtunnel="Warn"-->
	chStrengthBar();
	keyEncrySetting();
}
function keyEncrySetting()
{
		var test="<!--#nk_get VpnIPSecSetting="M_encKey"-->";
		var subString;
		if(document.formgtg.typeKeyMode[1])
		if(document.formgtg.typeKeyMode[1].selectedIndex==0)
		if(document.formgtg.typeEncryption[1])
		if(document.formgtg.typeEncryption[1].value==2)
		{
			document.formgtg.keyEncryption1.value=test.substring(0,16);
			document.formgtg.keyEncryption2.value=test.substring(16,32);
			document.formgtg.keyEncryption3.value=test.substring(32,48);
		}
}
function  checkMaxNumber()
{
	var Max;
	if(TotalPortNumber==6)
		Max=50;
	else
		Max=100;
	if(document.formgtg.tunnelNo.value>Max)
	{
		alert("Cannot be saved more than "+Max+" tunnels!");
		window.location.replace('vpn_summary.htm');
	}
}
function Leavefunction()
{
	chLeave();
}

function chStrengthBar()
{
	if(document.formgtg.PresharedKeyStrength)
	{
		if (document.formgtg.PresharedKeyStrength.checked == true)
		{
			document.getElementById("color_table").style.visibility = "visible";
			document.formgtg.PkStrength.value ="1";
		}
		else
		{
			document.getElementById("color_table").style.visibility = "hidden";
			document.formgtg.PkStrength.value ="0";
		}
		PrintColorBar(document.formgtg.keyPreshared2[1]);
	}	
}
function IPDNSCheck(I)
{    
	if (I.form.radioDnsResolve[1])
	if (I.form.radioDnsResolve[1].selectedIndex == 1);
	else    
		IPCheck(I);
}
function chDPD()
{    
	if(document.formgtg.tunnelBK)
	if (document.formgtg.tunnelBK.checked==true)
	{	    
		alert(aBKPDP);  
		document.formgtg.DPD.checked=true;
	}
}
function BKTimerCheck(I)
{
	var d;
	d=parseInt(I.value,10);
	if(!(d<=999 &d>=30))
	{
		alert(aBKTimerCheck);
		I.value=I.defaultValue;
		return;
	}
	I.value=d;
}
function chLGaT()
{    
	if (document.formgtg.tunnelStatus.checked==true)
	{
		if (document.formgtg.select6.selectedIndex==0)	
		{		    
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{		    	
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="A1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="A2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="A3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="A4"-->';
				}
			}		
		else if (document.formgtg.select6.selectedIndex==1)
		{		    
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{		    	
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="B1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="B2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="B3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="B4"-->';
				}
		}		
		else if (document.formgtg.select6.selectedIndex==2)
		{		    
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{		    	
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="C1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="C2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="C3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="C4"-->';
				}			
		}		
		else if (document.formgtg.select6.selectedIndex==3)
		{		    
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{		    	
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="D1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="D2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="D3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="D4"-->';
				}			
		}		
		else if (document.formgtg.select6.selectedIndex==4)
		{
			if (document.formgtg.typeLSW[1])	    	
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="E1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="E2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="E3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="E4"-->';
				}
		}
		else if (document.formgtg.select6.selectedIndex==5)
		{
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="F1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="F2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="F3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="F4"-->';
				}
		}
		else if (document.formgtg.select6.selectedIndex==6)
		{
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="G1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="G2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="G3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="G4"-->';
				}
		}
		else if (document.formgtg.select6.selectedIndex==7)		
		{
			if (document.formgtg.typeLSW[1])
				if (document.formgtg.typeLSW[1].selectedIndex<3)
				{
					document.formgtg.ipLSW1.value='<!--#nk_get VpnLswIp="H1"-->';
					document.formgtg.ipLSW2.value='<!--#nk_get VpnLswIp="H2"-->';
					document.formgtg.ipLSW3.value='<!--#nk_get VpnLswIp="H3"-->';
					document.formgtg.ipLSW4.value='<!--#nk_get VpnLswIp="H4"-->';
				}
		}
	}
}
function falseSubmit(F,n)
{
	if (F.typeKeyMode[1].selectedIndex==1) 
	{
	   if (F.PFSp[1].checked==true)
		   F.PFSp[0].value="checked";
	   else
		   F.PFSp[0].value="";
	}
	F.submitStatus.value=0;
	F.action="gateway_to_gateway.htm"+"#"+n;
	MM_showHideLayers('AutoNumber15','','hide'); 
	F.submit();
}
function changeStatus(F)
{
	if (F.tunnelStatus.checked==true)
	{
		F.tunnelStatusChange.value=1;		
		F.tunnelStatus.value=1;	
	}
	else
	{		
		if (F.editStatus.value=="0")
		{
			alert(aDisableTunnel);	
			return;	
		}
		F.tunnelStatusChange.value=2;
		F.tunnelStatus.value=0;
	}
	F.submitStatus.value=0;
	MM_showHideLayers('AutoNumber15','','hide');
	F.submit();
}
function falseSubmit1(F,n)
{
	if (F.typeKeyMode[1].selectedIndex==0) 
	{
	  if (F.PFSp[1].checked==true)
		  F.PFSp[0].value="checked";
	  else
		  F.PFSp[0].value="";
	}

	if (F.radioDnsResolve[1]) //F.typeRSW[1].selectedIndex =0, 1 or 2
	if (F.radioDnsResolve[1].selectedIndex == 1) 
	{
		sTrim(F.ipRSW1[1]);			      			  // Exchange to Normal Name	
		F.DnsResolve.value=F.ipRSW1[1].value;
		F.ipRSW1[1].value=F.ipRSW1[0].value;	
	}
	  
	F.submitStatus.value=0; 
	F.action="gateway_to_gateway.htm"+"#"+n;
	MM_showHideLayers('AutoNumber15','','hide');  	 
	F.submit();
}	
function lifetimeCheck(I)
{	
	return validatenum(I, 86401, 120, aSALifeTimeCheck);
}
function lifetime2Check(I)
{
	return validatenum(I, 28801, 120, aSALifeTime2Check);
}
function DPDtimeCheck(I)
{
	return validatenum(I, 1000, 10, aDPDTimeCheck);
}

function CancelSubmit(F)
{
	if (F.editStatus.value == 1)
		document.location.href="vpn_summary.htm";
	else
		document.location.href="gateway_to_gateway.htm";
}

function chSubmit(F)
{
	if (F.typeLSW[1])    
	{
		if(document.formgtg.typeLSW[1].value == 3||document.formgtg.typeLSW[1].value == 5)
		{
			var mail_l=F.L_userName[1].value.indexOf("@")
			var mail_r=F.L_domainName[1].value.indexOf("@")
			if (mail_l >= 0 || mail_r >= 0)
			{
				alert(aCheckName);
				return;
			}
		}
	}
	if (F.typeRSW[1])    
	{
		if(document.formgtg.typeRSW[1].value==3 ||document.formgtg.typeRSW[1].value==5)
		{
			var mail_l=F.R_userName[1].value.indexOf("@")
			var mail_r=F.R_domainName[1].value.indexOf("@")
			if (mail_l >= 0 || mail_r >= 0)
			{
				alert(aCheckName);
				return;
			}
		}
	}
	if(document.formgtg.PresharedKeyStrength)
	{
		if (document.formgtg.PresharedKeyStrength.checked == true)
		if(count_password_strength(F.keyPreshared2[1].value) < 10)
		{
		  alert("Preshared Key strength is not sufficient. Please change a new Preshared Key.");
		  return;
		}	

		if (document.formgtg.PresharedKeyStrength.checked == true)
			document.formgtg.PkStrength.value ="1";
		else
			document.formgtg.PkStrength.value ="0";			
	}	
 	if(F.select5[1]&&F.typehase2A[1])  
	if(F.select5[1].value==0&&F.typehase2A[1].value==0)  
	{
		alert(aP2AuthEncthesame);	
		return;    
	}
	if (F.tunnelName.value=="") 
	{
		alert(aTunnelName);
		F.tunnelName.select();
		return;  
	}
	if (F.tunnelStatus.checked==true)
	{
		if (F.typeLSW[1])    
		{
		if ((F.typeLSW[1].selectedIndex==1)||(F.typeLSW[1].selectedIndex==3))    
		{
			if (F.L_textFQDN[1])      
			if (F.L_textFQDN[1].value=="")       
			{
				alert(aDomainName);
				F.L_textFQDN[1].select();
				return;  
			}
		}
		else if ((F.typeLSW[1].selectedIndex==2)||(F.typeLSW[1].selectedIndex==4)) 
		{
			if (F.L_userName[1]) 
			if (F.L_userName[1].value=="") 
			{	  
				alert(aUserName);
				F.L_userName[1].select();
				return;      
			}
			if (F.L_domainName[1])
			if (F.L_domainName[1].value=="")
			{
				alert(aDomainName);	  
				F.L_domainName[1].select();	
				return;    
			}
		}
		}
		if (F.typeRSW[1])
		{
			if (F.radioDnsResolve[1]) //F.typeRSW[1].selectedIndex =0, 1 or 2
			if (F.radioDnsResolve[1].selectedIndex == 0)	//IP
			{
				if (chipRSW(F) < 0) 
					return;
			}
			else										//DNS
			{
				sTrim(F.ipRSW1[1]);
				if (F.ipRSW1[1].value=="")      
				{
					alert(aResolvedName);
					F.ipRSW1[1].select();	 
					return;      		
				}
			}
		}
		if (F.typeRSW[1]) 
		if ((F.typeRSW[1].selectedIndex==1)||(F.typeRSW[1].selectedIndex==3))    
		{
			if (F.R_textFQDN[1])      
			if (F.R_textFQDN[1].value=="") 
			{
				alert(aDomainName);	  
				F.R_textFQDN[1].select();
				return;     
			}
		}
		if (F.typeRSW[1])    
		if ((F.typeRSW[1].selectedIndex==2)||(F.typeRSW[1].selectedIndex==4))   
		{
			if (F.R_userName[1])     
			if (F.R_userName[1].value=="")
			{
				alert(aUserName);	  
				F.R_userName[1].select();	
				return;      
			}	
			if (F.R_domainName[1])   
			if (F.R_domainName[1].value=="") 
			{
				alert(aDomainName);
				F.R_domainName[1].select();
				return;      
			}    
		}
		if (F.typeRSG[1])	
		{
		if (F.typeRSG[1].selectedIndex==2)	
		{	   
			if (F.ipRSGbegin[1].value=="")
			{		    
				alert(aIPRangeRSG);
				F.ipRSGbegin[1].select();	
				return;	
			}else if (F.ipRSGend[1].value=="")
			{		    
				alert(aIPRangeRSG);
				F.ipRSGend[1].select();	
				return;	
			}
		}else
		{
                        if(F.ipRSG[1].value=="")
                        {
                                alert("Please input IP address");
                                F.ipRSG[1].select();
                                return;
                        }
			if(F.typeRSG[1].selectedIndex==1)
                        if(F.smRSG[1].value=="")
                        {
                                alert("Please input subnet mask.");
                                F.smRSG[1].select();
                                return;
                        }

                }
		}
		if (F.typeLSG[1])
		{	
		if (F.typeLSG[1].selectedIndex==2)	
		{	   
			if (F.ipLSGbegin[1].value=="")
			{		    
				alert(aIPRangeLSG);
				F.ipLSGbegin[1].select();	
				return;	
			}else if (F.ipLSGend[1].value=="")
			{		    
				alert(aIPRangeRSG);
				F.ipLSGend[1].select();	
				return;	
			}
		}else
		{
			if(F.ipLSG[1].value=="")
			{
				alert("Please input IP address");
				F.ipLSG[1].select();
                                return;
			}
			if(F.typeLSG[1].selectedIndex==1)
			if(F.smLSG[1].value=="")
			{
				alert("Please input subnet mask.");
                                F.smLSG[1].select();
                                return;
			}
		}
		}
		if (F.typeKeyMode[1])    
		if (F.typeKeyMode[1].selectedIndex==0)    
		{	  
			if (F.inSPI[1]) 
			if (F.inSPI[1].value=="")
			{	  
				alert(aIncomeSPI);	
				F.inSPI[1].select();	  
				return;      
			}
			if (F.outSPI[1])
			if (F.outSPI[1].value=="")   
			{	  
				alert(aOutgoSPI);	  
				F.outSPI[1].select();
				return;      
			}	  
			//if (F.keyEncryption[1]) 
			if(F.typeEncryption[1].value==1)
			{
				if (F.keyEncryption[1].value=="")    
				{
					alert(aEncryptionKey);	  
					F.keyEncryption[1].select();	
					return;     
				}
			}
			else if(F.typeEncryption[1].value==2)	
			{
				if(F.keyEncryption1.value=="")
				{
					alert(aEncryptionKey);
					F.keyEncryption1.select();
                                        return;
				}
				else if(F.keyEncryption2.value=="")
                                {
                                        alert(aEncryptionKey);
                                        F.keyEncryption2.select();
                                        return;
                                }
				else if(F.keyEncryption3.value=="")
                                {
                                        alert(aEncryptionKey);
                                        F.keyEncryption3.select();
                                        return;
                                }
				else if((F.keyEncryption1.value==F.keyEncryption2.value)||(F.keyEncryption3.value==F.keyEncryption2.value))
				{
					alert("Encryption keys should be different!");
					F.keyEncryption1.select();
					return;
				}
				F.keyEncryption[1].value=F.keyEncryption1.value+F.keyEncryption2.value+F.keyEncryption3.value;
//				alert(F.keyEncryption[1].value);
//				return;
			}
			if (F.keyAuthentication[1])  
			if (F.keyAuthentication[1].value=="")
			{	
				alert(aAuthenticationKey);
				F.keyAuthentication[1].select();	
				return;   
			}
		}
		if (F.typeKeyMode[1].selectedIndex==1)
		{	  
			if (F.keyPreshared2[1])
			if (F.keyPreshared2[1].value=="")
			{
				alert(aPresharedKey);	  
				F.keyPreshared2[1].select();	  
				return;      
			}
			if (F.lifetimeSA1[1])
			if (F.lifetimeSA1[1].value=="")  
			{	  
				alert(aP1SALifeTime);
				F.lifetimeSA1[1].select();
				return;    
			}	 
			if (F.lifetimeSA2[1])  
			if (F.lifetimeSA2[1].value=="")   
			{	  
				alert(aP2SALifeTime);
				F.lifetimeSA2[1].select();
				return;
			}
		}
	}
	if(F.typeKeyMode[1])  
	{
		if (F.typeKeyMode[1].selectedIndex==0)
		{     
			if (F.PFSp.checked==true)
				F.PFSp.value=1;     
			else	  
				F.PFSp.value=0; 
		}
	}
	if(F.tunnelBK)
	if(F.tunnelBK.checked==true)
	if(F.ipRemoteBK.value=="")
	{
		alert("Please input Remote Backup IP Address");
		F.ipRemoteBK.select();
		return;
	}
	if(F.dnsSplit)
	if(F.dnsSplit.checked==true)
	{
		if(F.dns1Split.value=="")
		{
			alert("Please input DNS IP.");
			F.dns1Split.select();
			return;
		}
		if(F.host1Split.value=="")
		{
                        alert("Please input host name.");
                        F.host1Split.select();
                        return;
		}
	}
	if(F.DPD)
	if(F.DPD.checked==true)
	{
		if(F.DPDInterval.value=="")
		{
			alert("Please input DPD Interval time.");
			F.DPDInterval.select();
                        return;
		}
	}
	F.submitStatus.value=1;  
	F.log_ch.value=1;
	F.tunnelStatusChange.value=0;
	window.status=wSave;	
	MM_showHideLayers('AutoNumber15','','hide');
	F.submit();
}
function chipRSW(F)
{	
	if(F.ipRSW[1])
	if(F.ipRSW[1].value=="")
	{
		alert(aIPAddressRSW);
		F.ipRSW[1].select();
		return -1;	
	}
	else if (F.ipRSW[1].value=="0.0.0.0")	 
	{		
		alert(aIPRSWCheck);
		F.ipRSW[1].select();	
		return -1;		
	}
	return 1;
}

function checkKeySize(change)
{
	if (document.formgtg.keyEncryption[1])
	if (change=="E") 
		document.formgtg.keyEncryption[1].value="";
	if (document.formgtg.keyAuthentication[1])		
	if (change=="A")		
		document.formgtg.keyAuthentication[1].value="";
	if (document.formgtg.tunnelStatus.checked==true)	
	{   
		if (document.formgtg.typeKeyMode[1])		
		if (document.formgtg.typeKeyMode[1].selectedIndex==0)	
		{
			if (document.formgtg.typeEncryption[1])
			if (document.formgtg.typeEncryption[1].selectedIndex==0) 	
			{
				document.formgtg.keyEncryption[1].size=16;
				document.formgtg.keyEncryption[1].maxLength=16;
			}
			if (document.formgtg.typeEncryption[1])		
			if (document.formgtg.typeEncryption[1].selectedIndex==1) 
			{
				document.formgtg.keyEncryption[1].size=48;		
				document.formgtg.keyEncryption[1].maxLength=48;
			}
			if (document.formgtg.typeAuthentication[1])	
			if (document.formgtg.typeAuthentication[1].selectedIndex==0) 
			{
				document.formgtg.keyAuthentication[1].size=32;
				document.formgtg.keyAuthentication[1].maxLength=32;
			}
			if (document.formgtg.typeAuthentication[1])
			if (document.formgtg.typeAuthentication[1].selectedIndex==1) 
			{
				document.formgtg.keyAuthentication[1].size=40;		
				document.formgtg.keyAuthentication[1].maxLength=40;
			}
		}
	}
}
function KEYCheck(key,type,I)
{	
	var inputLength;
	var formLength;
	var charF;	
	var stringInput;
	var stringZero="";  
	inputLength=I.value.length;
	if (key=="E")	
	{		
		for (var i=0; i<inputLength; i++)	
		{			
			charF=parseInt(I.value.charAt(i),16);
			if (isNaN(charF))			
			{				
				alert(aEncryptionKeyCheck);	
				I.value=I.defaultValue;	
				return;		
			}	  	
		}			
		if (type==0) //16	
		{			
			formLength=16;	
		}	
		if (type==1) //48	
		{			
			formLength=48;
		}
	}	  	
	if (key=="A") 	
	{		
		for (var i=0; i<inputLength; i++)
		{
			charF=parseInt(I.value.charAt(i),16);	
			if (isNaN(charF))
			{		
				alert(aAuthenticationKeyCheck);
				I.value=I.defaultValue;		
				return;			
			}	  		
		} 		
		if (type==0) //32	
			formLength=32;	
		if (type==1) //40	
			formLength=40;
	}
	if (inputLength<formLength)	
	{
		for (var j=0; j<(formLength-inputLength); j++)	
		{
			stringZero+="0";	
		}	
		stringInput=I.value;
		I.value=stringInput+stringZero;
	}
}
function SPICheck(SPI,I)
{  
	var stringInput;  
	var charF; 
	var j=0; 
	for (var i=0; i<I.value.length; i++)
	{
		charF=parseInt(I.value.charAt(i),16);
		if (isNaN(charF)) 
		{
			if (SPI=="I") 
				alert(aIncomeSPIHexCheck);
			if (SPI=="O") 
				alert(aOutgoSPIHexCheck);	 
			I.value=I.defaultValue;    
			return;    
		}	   
	}  
	while (I.value.charAt(j)=="0") 
		j++; 
	stringInput=I.value.substring(j,I.value.length); 
	if (stringInput.length<3) 
	{   
		if (SPI=="I") alert(aIncomeSPICheck);  
		if (SPI=="O") alert(aOutgoSPICheck);   
		I.value=I.defaultValue;
	}
	else  
	{
		I.value=stringInput; 
	}
}
function opAdvanced(I,F)
{ 
	if (I.value=="1") 
	{  	
		F.action="gateway_to_gateway.htm#13";	
		F.advancedStatus.value="0";    
		F.submitStatus.value="11";
		//close area 
	}
	else 
	{  	
		F.action="gateway_to_gateway.htm#14";
		F.advancedStatus.value="1"; 
		F.submitStatus.value="10";  
		//open area 
	}    
	if (F.radioDnsResolve[1]) //F.typeRSW[1].selectedIndex =0, 1 or 2  
	if (F.radioDnsResolve[1].selectedIndex == 1) 
	{			     
		sTrim(F.ipRSW1[1]);
		// Exchange to Normal Name
		F.DnsResolve.value=F.ipRSW1[1].value;
		F.ipRSW1[1].value=F.ipRSW1[0].value;  
	}
	if(F.PFSp[1]) 
	{ 
		if (F.PFSp[1].checked==true)
			F.PFSp[0].value=1;  
		else	  
			F.PFSp[0].value=0; 
	}
	MM_showHideLayers('AutoNumber15','','hide');  	
	F.submit();
}
function pageReset()
{   
	if (document.formgtg.pageStatus.value=="1")
	{	
		document.formgtg.submitStatus.value="111";
		MM_showHideLayers('AutoNumber15','','hide');  	
		document.formgtg.submit();
	}
	else	
		window.location.replace('gateway_to_gateway.htm');
}
function chAfterSubmit()
{  
	var y;  
	y=cGatewayToGatewayOk; 
	if (document.formgtg.afterSubmit.value=="1") 
	{      
		if (!confirm(y))   
			window.location.replace("vpn_summary.htm");
		else
			window.location.replace("gateway_to_gateway.htm");
	}
	else if (document.formgtg.afterSubmit.value=="2")
	{
		window.location.replace("vpn_summary.htm");
	}
	if (document.formgtg.areaMark.value=="1")   
		document.location="#1";
}

function count_password_strength(password_string)
{
	 var temp="";   
	 var score=8;
	 
	 if(password_string.length < 8)
	     return score;

	 for(var i=0;i<password_string.length;i++)
	 {			 
		if(password_string.charCodeAt(i) >= 65 && password_string.charCodeAt(i) <=90 )
			temp+="A";
		else if(password_string.charCodeAt(i) >= 97 && password_string.charCodeAt(i) <= 122 )
			temp+="a";
		else if(password_string.charCodeAt(i) >= 48 && password_string.charCodeAt(i) <= 57 )
			temp+="1";
		else
			temp+="#";
	 }
	 score=0;

	 for(i=1;i<temp.length;i++)
	 {
	     if(temp.charCodeAt(i) != temp.charCodeAt(i-1) )
		     score++;		
	 }
     score+=temp.length;
	return score;	
}

function PrintColorBar(password)
{
	var public_vNum;

	if(password)
		public_vNum=count_password_strength(password.value)/2;
	else
		public_vNum=4;
	for (var i=1; i<15;i++)
	{
		var temp = "s"+i;
		
		if (document.formgtg.PresharedKeyStrength.checked == true)
		{
			if (i <= public_vNum)
				document.getElementById(temp).style.visibility = "visible";
			else 
				document.getElementById(temp).style.visibility = "hidden";	
		}
		else
			document.getElementById(temp).style.visibility = "hidden";
	}
}

//================= End =================*/

/***************************************************/
/*												   */	
/*      			  Begin of content    				   */
/*												   */	
/***************************************************/
var ButtonType = "OkCancel";		// NULL/Refresh/OkCancel/BackOkCancel/ShowTableOkCancel
var Savelink = "chSubmit(document.formgtg);";
var Cancellink = "CancelSubmit(document.formgtg)"; 
var helplink ='help_gateway_to_gateway.htm';
var UserName = '<!--#nk_get DisplayOnly="nUser"-->';
var head_width=215;
		
function PrintContent()
{
	PrintBeginContent();
	PrintTunnelEnable(1);
	if (document.formgtg.tunnelStatus.checked)
	{
		PrintLocalGroupSetup(1);
		PrintRemoteGroupSetup(1);
		PrintIPSecSetup(1);
	}
	PrintEndContent();
}

function PrintTunnelEnable(hasUnderLine)
{
	PrintBeginBlock(1, "Add a New Tunnel");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');	
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Tunnel No.&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="hidden" name="tunnelNo" value=\'<!--#nk_get VpnG2Gtunnel="tNo"-->\'>');
	document.write('<!--#nk_get VpnG2Gtunnel="tNo"-->');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Tunnel Name&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="text" name="tunnelName" size="20" maxlength="40" value=\'<!--#nk_get VpnG2Gtunnel="tName"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Interface&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="Select" name="select6" onChange="chLGaT(); falseSubmit(this.form,\'10\');" style="width:133px">');
	document.write('<option value="1" <!--#nk_get VpnG2Gtunnel="tWAN1"-->>WAN1</option>');
	for (i=2; i <= document.formgtg.wanNumbers.value-document.formgtg.isDMZmode.value; i++)
	{			
		document.write('<option value="'+i+'" ');
		if(i==2) document.write('<!--#nk_get VpnG2Gtunnel="tWAN2"-->');
		else if(i==3) document.write('<!--#nk_get VpnG2Gtunnel="tWAN3"-->');
		else if(i==4) document.write('<!--#nk_get VpnG2Gtunnel="tWAN4"-->');
		else if(i==5) document.write('<!--#nk_get VpnG2Gtunnel="tWAN5"-->');			
		else if(i==6) document.write('<!--#nk_get VpnG2Gtunnel="tWAN6"-->');			
		else if(i==7) document.write('<!--#nk_get VpnG2Gtunnel="tWAN7"-->');					
		document.write('>');			
		document.write("WAN"+i);			
		document.write('</option>');
	}
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Enable&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="checkbox" name="tunnelStatus" onClick="changeStatus(this.form)" value="1" <!--#nk_get VpnG2Gtunnel="enable"-->>');
	document.write('</td>');
	document.write('</tr>');
	document.write('</table>');
	if (document.formgtg.tunnelStatus.checked)
		PrintEndBlock(1, 0, 1);
	else
		PrintEndBlock(0);
}
function PrintLocalGroupSetup(hasUnderLine)
{
	PrintBeginBlock(1, "Local Group Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');	
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Local Security Gateway Type&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeLSW" onChange="falseSubmit(this.form,\'11\')">');
	document.write('<option value="1" <!--#nk_get G2GtypeLSW="1"-->>IP Only</option>');
	document.write('<option value="2" <!--#nk_get G2GtypeLSW="2"-->>IP + Domain Name(FQDN) Authentication</option>');
	document.write('<option value="3" <!--#nk_get G2GtypeLSW="3"-->>IP + Email Address(USER FQDN) Authentication</option>');
	document.write('<option value="4" <!--#nk_get G2GtypeLSW="4"-->>Dynamic IP + Domain Name(FQDN) Authentication</option>');
	document.write('<option value="5" <!--#nk_get G2GtypeLSW="5"-->>Dynamic IP + Email Address(USER FQDN) Authentication</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	//Domain Name:
	if(document.formgtg.typeLSW[1].value == 2||document.formgtg.typeLSW[1].value == 4)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Domain Name&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="L_textFQDN" size="40" maxlength="40" value=\'<!--#nk_get VpnLswIp="FQDN"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write('</td>');
		document.write('</tr>');
	}
	//Email address:
	else if(document.formgtg.typeLSW[1].value == 3||document.formgtg.typeLSW[1].value == 5)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Email Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="L_userName" size="10" maxlength="20" value=\'<!--#nk_get VpnLswIp="userName"-->\'  onFocus="this.select();" onBlur="">');
		document.write(' @ ');
		document.write('<input type="text" name="L_domainName" size="40" maxlength="40" value=\'<!--#nk_get VpnLswIp="domainName"-->\'  onFocus="this.select();" onBlur="">');
		document.write('</td>');
		document.write('</tr>');
	}
	//IP address:
	if(document.formgtg.typeLSW[1].value < 4)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('IP Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		chLGaT();
		document.write(document.formgtg.ipLSW1.value+"."+document.formgtg.ipLSW2.value+"."+document.formgtg.ipLSW3.value+"."+document.formgtg.ipLSW4.value);
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('<tr>');
	document.write('<td>');
	document.write('Local Security Group Type&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeLSG" onChange="falseSubmit(this.form,\'11\')" style="width:133px">');
	document.write('<option value="1" <!--#nk_get G2GtypeLSG="1"-->>IP</option>');
	document.write('<option value="2" <!--#nk_get G2GtypeLSG="2"-->>Subnet</option>');
	document.write('<option value="3" <!--#nk_get G2GtypeLSG="3"-->>IP Range</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	//IP
	if(document.formgtg.typeLSG[1].value < 3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('IP Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');	
		document.write('<input type="text" name="ipLSG" size="20" maxlength="20" value=\'<!--#nk_get NewVpnLsgIp="IP"-->\' onBlur="IPCheck(this)" onKeypress="return Check_User_Input(event)">');
		document.write('</td>');
		document.write('</tr>');
	}
	//subnet
	if(document.formgtg.typeLSG[1].value == 2)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Subnet Mask&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="smLSG" size="20" maxlength="20" value=\'<!--#nk_get NewVpnLsgIp="Mask"-->\' onBlur="IPCheck(this,0,255)" onKeypress="return Check_User_Input(event)">');	
		document.write('</td>');
		document.write('</tr>');
	}
	else if(document.formgtg.typeLSG[1].value == 3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Begin IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');	
		document.write('<input type="text" name="ipLSGbegin" size="20" maxlength="20" value=\'<!--#nk_get NewVpnLsgIp="Begin"-->\' onBlur="IPRangeCheck(this.form.ipLSGbegin[1],this.form.ipLSGend[1])" onKeypress="return Check_User_Input(event)">');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('End IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="ipLSGend" size="20" maxlength="20" value=\'<!--#nk_get NewVpnLsgIp="End"-->\' onBlur="IPRangeCheck(this.form.ipLSGbegin[1],this.form.ipLSGend[1])" onKeypress="return Check_User_Input(event)">');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('</table>');
	PrintEndBlock(hasUnderLine, 0, 1);
}
function PrintRemoteGroupSetup(hasUnderLine)
{
	PrintBeginBlock(1, "Remote Group Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Remote Security Gateway Type&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeRSW" onChange="falseSubmit(this.form,\'12\')">');
	document.write('<option value="1" <!--#nk_get G2GtypeRSW="1"-->>IP Only</option>');
	document.write('<option value="2" <!--#nk_get G2GtypeRSW="2"-->>IP + Domain Name(FQDN) Authentication</option>');
	document.write('<option value="3" <!--#nk_get G2GtypeRSW="3"-->>IP + Email Address(USER FQDN) Authentication</option>');
	document.write('<option value="4" <!--#nk_get G2GtypeRSW="4"-->>Dynamic IP + Domain Name(FQDN) Authentication</option>');
	document.write('<option value="5" <!--#nk_get G2GtypeRSW="5"-->>Dynamic IP + Email Address(USER FQDN) Authentication</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	if(document.formgtg.typeRSW[1].value < 4)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('<select class="select" name="radioDnsResolve" onChange="falseSubmit(this.form,\'12\')">');
		document.write('<option value="0" <!--#nk_get NewVpnRswIp="radioDnsResolve:0"-->>IP Address</option>');
		document.write('<option value="1" <!--#nk_get NewVpnRswIp="radioDnsResolve:1"-->>IP by DNS Resolved</option>');
		document.write('</select>&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		if(document.formgtg.radioDnsResolve[1].value==0)
			document.write('<input type="text" name="ipRSW" size="20" maxlength="20" onBlur="IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get NewVpnRswIp="A"-->\'>');
		else
			document.write('<input type="text" name="ipRSW1" size="20" maxlength="60" onBlur=" IPDNSCheck(this);" value=\'<!--#nk_get NewVpnRswIp="DnsResolve"-->\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	if(document.formgtg.typeRSW[1].value==2 ||document.formgtg.typeRSW[1].value==4)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Domain Name&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="R_textFQDN" size="40" maxlength="40" value=\'<!--#nk_get VpnRswIp="FQDN"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write('</td>');
		document.write('</tr>');
	}
	if(document.formgtg.typeRSW[1].value==3 ||document.formgtg.typeRSW[1].value==5)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Email Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="R_userName" size="10" maxlength="20" value=\'<!--#nk_get VpnRswIp="userName"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write(' @ ');
		document.write('<input type="text" name="R_domainName" size="40" maxlength="40" value=\'<!--#nk_get VpnRswIp="domainName"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('<tr>');
	document.write('<td>');
	document.write('Remote Security Group Type&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeRSG" onChange="falseSubmit(this.form,\'12\')" style="width:133px">');
	document.write('<option value="1" <!--#nk_get G2GtypeRSG="1"-->>IP</option>');
	document.write('<option value="2" <!--#nk_get G2GtypeRSG="2"-->>Subnet</option>');
	document.write('<option value="3" <!--#nk_get G2GtypeRSG="3"-->>IP Range</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	//
	if(document.formgtg.typeRSG[1].value < 3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('IP Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="ipRSG" size="20" maxlength="20" onBlur=" IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get NewVpnRsgIp="IP"-->\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	if(document.formgtg.typeRSG[1].value == 2)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Subnet Mask&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="smRSG" size="20" maxlength="20" onBlur=" IPCheck(this,0,255);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get NewVpnRsgIp="Mask"-->\'>');
		document.write('</td>');
		document.write('</tr>');
	}else if (document.formgtg.typeRSG[1].value == 3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Begin IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="ipRSGbegin" size="20" maxlength="20" onBlur=" IPRangeCheck(this.form.ipRSGbegin[1],this.form.ipRSGend[1]);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get NewVpnRsgIp="Begin"-->\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('End IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="ipRSGend" size="20" maxlength="20" onBlur=" IPRangeCheck(this.form.ipRSGbegin[1],this.form.ipRSGend[1]);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get NewVpnRsgIp="End"-->\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('</table>');
	PrintEndBlock(hasUnderLine, 0, 1);
}
function PrintIPSecSetup(hasUnderLine)
{
	PrintBeginBlock(1, "IPSec Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Keying Mode&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeKeyMode" onChange="falseSubmit1(this.form,\'13\')" style="width:182px">');
	document.write('<option value="1" <!--#nk_get G2GtypeKeyMode="1"-->>Manual</option>');
	document.write('<option value="2" <!--#nk_get G2GtypeKeyMode="2"-->>IKE with Preshared key</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	if(document.formgtg.typeKeyMode[1].value == 2)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 1 DH Group&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="selectdh" style="width:183px">');
		document.write('<option value="1" <!--#nk_get VpnIPSecSetting="Grp1"-->>Group 1 - 768 bit</option>');
		document.write('<option value="2" <!--#nk_get VpnIPSecSetting="Grp2"-->>Group 2 - 1024 bit</option>');
		document.write('<option value="3" <!--#nk_get VpnIPSecSetting="Grp5"-->>Group 5 - 1536 bit</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 1 Encryption&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="select2" style="width:183px">');
		document.write('<option value=1 <!--#nk_get VpnIPSecSetting="Aphase1Des"-->>DES</option> ');		
		document.write('<option value=2 <!--#nk_get VpnIPSecSetting="Aphase13Des"-->>3DES</option> ');		
		document.write('<option value=3 <!--#nk_get VpnIPSecSetting="Aphase1Aes128"-->>AES-128</option>');		
		document.write('<option value=4 <!--#nk_get VpnIPSecSetting="Aphase1Aes192"-->>AES-192</option>');		
		document.write('<option value=5 <!--#nk_get VpnIPSecSetting="Aphase1Aes256"-->>AES-256</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 1 Authentication&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="select3" style="width:183px">');
		document.write('<option value="1" <!--#nk_get VpnIPSecSetting="Aphase1Md5"-->>MD5</option>');
		document.write('<option value="2" <!--#nk_get VpnIPSecSetting="Aphase1Sha1"-->>SHA1</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 1 SA Life Time&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="lifetimeSA1" size="18" maxlength="10" onFocus="this.select();" onBlur=" lifetimeCheck(this)" value=\'<!--#nk_get VpnIPSecSetting="LifetimeSA1"-->\'>');
		document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
		document.write('seconds');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Perfect Forward Secrecy&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="checkbox" name="PFSp" onClick="falseSubmit(this.form,\'13\');" value="1" <!--#nk_get G2GtypePFSp=""-->>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 2 DH Group&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="select4" style="width:183px">');
		document.write('<option value="1" <!--#nk_get VpnIPSecSetting="2Grp1"-->>Group 1 - 768 bit</option>');
		document.write('<option value="2" <!--#nk_get VpnIPSecSetting="2Grp2"-->>Group 2 - 1024 bit</option>');
		document.write('<option value="3" <!--#nk_get VpnIPSecSetting="2Grp5"-->>Group 5 - 1536 bit</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 2 Encryption&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="select5" style="width:183px">');
		document.write('<option value=0 <!--#nk_get VpnIPSecSetting="Aphase2Null"-->>NULL</option>');		
		document.write('<option value=1 <!--#nk_get VpnIPSecSetting="Aphase2Des"-->>DES</option>');		
		document.write('<option value=2 <!--#nk_get VpnIPSecSetting="Aphase23Des"-->>3DES</option> ');		
		document.write('<option value=3 <!--#nk_get VpnIPSecSetting="Aphase2Aes128"-->>AES-128</option>');		
		document.write('<option value=4 <!--#nk_get VpnIPSecSetting="Aphase2Aes192"-->>AES-192</option>');		
		document.write('<option value=5 <!--#nk_get VpnIPSecSetting="Aphase2Aes256"-->>AES-256</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 2 Authentication&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="typehase2A" style="width:183px">');
		document.write('<option value="0" <!--#nk_get VpnIPSecSetting="Aphase2None"-->>NULL</option>');
		document.write('<option value="1" <!--#nk_get VpnIPSecSetting="Aphase2Md5"-->>MD5</option>');
		document.write('<option value="2" <!--#nk_get VpnIPSecSetting="Aphase2Sha1"-->>SHA1</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 2 SA Life Time&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="lifetimeSA2" size="18" maxlength="10" onFocus="this.select();" onBlur=" lifetimeCheck(this)" value=\'<!--#nk_get VpnIPSecSetting="Lifetime"-->\'>');
		document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');	
		document.write('seconds');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Preshared Key&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="keyPreshared2" size="30" maxlength="64" onFocus="this.select();" onBlur="sTrim(this);" onkeyup="PrintColorBar(this);" value=\'<!--#nk_get VpnIPSecSetting="PreshareKey"-->\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');	
		document.write('<td>Minimum Preshared Key Complexity&nbsp;:&nbsp;</td>');
		document.write('<td>');
		if(document.formgtg.PkStrength.value == "0")
		    document.write('<input type="checkbox" name="PresharedKeyStrength" value=1 onClick="chStrengthBar()">');
		else
		    document.write('<input type="checkbox" name="PresharedKeyStrength" value=1 onClick="chStrengthBar()" checked >');
		document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
		document.write('Enable');
		document.write('</td>');	
		document.write('<td></td>');
		document.write('</tr>');	
		document.write('<tr>');	
		document.write('<td>Preshared Key Strength Meter&nbsp;:&nbsp;</td>');
		document.write('<td>');
		document.write('<table id="color_table" class="meterbg" align="left" border="0" style="'+Tablestyle+'">');
		document.write('<tr>');
		document.write('<td height="18" style="padding-right:0px; padding-bottom:0px;">');
		document.write('<img id="s1" border="1" src="images/red.gif" width="10" height="2" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s2" border="1" src="images/red.gif" width="10" height="3" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s3" border="1" src="images/red.gif" width="10" height="4" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s4" border="1" src="images/red.gif" width="10" height="5" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');	
		document.write('<img id="s5" border="1" src="images/yellow.gif" width="10" height="6" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s6" border="1" src="images/yellow.gif" width="10" height="7" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s7" border="1" src="images/yellow.gif" width="10" height="8" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s8" border="1" src="images/yellow.gif" width="10" height="9" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');	
		document.write('<img id="s9" border="1" src="images/yellow.gif" width="10" height="10" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s10" border="1" src="images/green.gif" width="10" height="11" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s11" border="1" src="images/green.gif" width="10" height="12" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
		document.write('<img id="s12" border="1" src="images/green.gif" width="10" height="13" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');		
		document.write('<img id="s13" border="1" src="images/green.gif" width="10" height="14" style="visibility:hidden; border-color:#002142">');
		document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');		
		document.write('<img id="s14" border="1" src="images/green.gif" width="10" height="15" style="visibility:hidden; border-color:#002142">');	
		document.write('</td>');
		document.write('</tr>');
		document.write('</table>');	
		document.write('</td>');	
		document.write('<td></td>');
		document.write('</tr>');		
		document.write('<tr>');
		document.write('<td colspan=2>');
		document.write('<input type="hidden" name="advancedStatus" value=\'<!--#nk_get G2GAdvStatus=""-->\'>');
		if (document.formgtg.advancedStatus.value == 1)
			PrintSTButton("showNew", "Advanced - ", "opAdvanced(document.formgtg.advancedStatus,document.formgtg);");
		else	
			PrintSTButton("showNew", "Advanced + ", "opAdvanced(document.formgtg.advancedStatus,document.formgtg);");
		document.write('</td>');
		document.write('</tr>');
		document.write('</table>');
	}
	else
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Incoming SPI&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="inSPI" maxlength="8" size="8" onFocus="this.select();" onBlur=" SPICheck(\'I\',this)" value=\'<!--#nk_get VpnIPSecSetting="M_inSPI"-->\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Outgoing SPI&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="outSPI" maxlength="8" size="8" onFocus="this.select();" onBlur=" SPICheck(\'O\',this)" value=\'<!--#nk_get VpnIPSecSetting="M_outSPI"-->\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Encryption&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="typeEncryption" onChange="falseSubmit(this.form,\'12\')" style="width:133px">');
		document.write('<option value=1 <!--#nk_get VpnIPSecSetting="M_des"-->>DES</option>');
		document.write('<option value=2 <!--#nk_get VpnIPSecSetting="M_3des"-->>3DES</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Authentication&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="typeAuthentication" onChange="checkKeySize(\'A\')" style="width:133px">');
		document.write('<option value=1 <!--#nk_get VpnIPSecSetting="M_md5"-->>MD5</option>');
		document.write('<option value=2 <!--#nk_get VpnIPSecSetting="M_sha1"-->>SHA1</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Encryption Key&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		//
		if(document.formgtg.typeEncryption[1].value==1)
			document.write('<input type="text" name="keyEncryption" maxlength="50" size="8" onFocus="this.select();" onBlur="KEYCheck(\'E\',this.form.typeEncryption[1].selectedIndex,this)" value=\'<!--#nk_get VpnIPSecSetting="M_encKey"-->\'>');
		else
		{
			document.write('<input type="hidden" name="keyEncryption" value=\'<!--#nk_get VpnIPSecSetting="M_encKey"-->\'>');
			document.write('<input type="text" name="keyEncryption1" maxlength="16" size="17" onBlur="KEYCheck(\'E\',0,this)" value="">&nbsp;');
			document.write('<input type="text" name="keyEncryption2" maxlength="16" size="17" onBlur="KEYCheck(\'E\',0,this)" value="">&nbsp;');
			document.write('<input type="text" name="keyEncryption3" maxlength="16" size="17" onBlur="KEYCheck(\'E\',0,this)" value="">');
		}
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('Authentication Key&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="keyAuthentication" maxlength="50" size="8" onFocus="this.select();" onBlur="KEYCheck(\'A\',this.form.typeAuthentication[1].selectedIndex,this)" value=\'<!--#nk_get VpnIPSecSetting="M_authKey"-->\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('</table>');
	}	
	if(document.formgtg.typeKeyMode[1].value == 2 && document.formgtg.advancedStatus.value == 1)
	{
		PrintEndBlock(1, 0, 1);
		PrintAdvanced(0);
	}
	else
		PrintEndBlock(0);
}
function PrintAdvanced(hasUnderLine)
{
	PrintBeginBlock(1, "Advanced");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="10">');
	document.write('<input type="checkbox" name="aggressiveMode" value="1" <!--#nk_get VpnAdvance="aggressiveMode"-->>');
	document.write('</td>');
	document.write('<td width="'+(head_width-26)+'">');
	document.write('Aggressive Mode');
	document.write('</td>');
	document.write('<td width="300"></td>');
	document.write('<td></td>');	
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="IPComp" value="1" <!--#nk_get VpnAdvance="IPComp"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('Compress (Support IP Payload Compression Protocol(IPComp))');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="keepAlive"  value="1" <!--#nk_get VpnAdvance="keepAlive"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('Keep-Alive');
	document.write('</td>');	
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="ahHash" value="1" <!--#nk_get VpnAdvance="ahHash"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('AH Hash Algorithm');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('<select class="select" name="ahAlg">');
	document.write('<option value="1" <!--#nk_get VpnAdvance="ahAlgMD5"-->>MD5</option>');
	document.write('<option value="2" <!--#nk_get VpnAdvance="ahAlgSHA1"-->>SHA1</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');	
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="biosBC"  value="1" <!--#nk_get VpnAdvance="biosBC"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('NetBIOS Broadcast');
	document.write('</td>');
	document.write('</tr>');		
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="NATT" value="1" <!--#nk_get VpnAdvance="NATT"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('NAT Traversal');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="DPD" value="1"  onClick="chDPD()" <!--#nk_get VpnAdvance="DPD"-->>');
	document.write('</td>');
	document.write('<td colspan="3">');
	document.write('Dead Peer Detection Interval');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('<input type="text" name="DPDInterval" maxlength=3 size=3 onFocus="this.select();" onBlur=" DPDtimeCheck(this)" value=\'<!--#nk_get VpnAdvance="DPDInterval"-->\'>');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');	
	document.write('seconds');
	document.write('</td>');		
	document.write('</tr>');
	if (MaxWanPortNumber == 2)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('<input type="checkbox" name="tunnelBK"  value=\'1\' onClick="chDPD()" <!--#nk_get VpnAdvance="tunnelBK"-->>');
		document.write('</td>');
		document.write('<td  colspan=3>');
		document.write('Tunnel Backup :');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Remote Backup IP Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="ipRemoteBK" size="20" maxlength="20" onFocus="this.select();" onBlur=" IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnAdvance="ipRemoteBK"-->\'>');
		document.write('</td>');
		document.write('<td></td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Local Interface&nbsp;:&nbsp;');
		document.write('</td>');	
		document.write('<td>');
		document.write('<select class="select" name="iFaceBK" style="width:133px">');
		document.write('<option value="1" <!--#nk_get VpnAdvance="iFaceBK1"-->>WAN1</option>');
		for (i=2; i <= document.formgtg.wanNumbers.value-document.formgtg.isDMZmode.value; i++)
		{
			document.write('<option value="'+i+'" ');
			if(i==2) document.write('<!--#nk_get VpnAdvance="iFaceBK2"-->');
			else if(i==3) document.write('<!--#nk_get VpnAdvance="iFaceBK3"-->');
			else if(i==4) document.write('<!--#nk_get VpnAdvance="iFaceBK4"-->');
			else if(i==5) document.write('<!--#nk_get VpnAdvance="iFaceBK5"-->');			
			else if(i==6) document.write('<!--#nk_get VpnAdvance="iFaceBK6"-->');			
			else if(i==7) document.write('<!--#nk_get VpnAdvance="iFaceBK7"-->');						
			document.write('>');			
			document.write("WAN"+i);			
			document.write('</option>');
		}
		document.write('</select>');
		document.write('</td>');
		document.write('<td></td>');	
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('VPN Tunnel Backup Idle Time&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="BKTimer" maxlength=3 size=9 onFocus="this.select();" onBlur=" BKTimerCheck(this)" value=\'<!--#nk_get VpnAdvance="BKTimer"-->\'>');
		document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');	
		document.write('seconds (Range:30~999 sec) ');
		document.write('</td>');
		document.write('<td></td>');	
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('<input type="checkbox" name="dnsSplit"  value="1" onClick="" <!--#nk_get VpnAdvance="dnsSplit"-->>');
		document.write('</td>');
		document.write('<td colspan=3>');
		document.write('Split DNS :');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('DNS1 : ');
		document.write('</td>');	
		document.write('<td>');
		document.write('<input type="text" name="dns1Split" size="20" maxlength="20" onFocus="this.select();" onBlur=" IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnAdvance="dns1Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');	
		document.write('</tr>');	
		document.write('<tr>');
		document.write('<td>');
		document.write('</td>');
		document.write('<td>');
		document.write('DNS2 : ');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="dns2Split" size="20" maxlength="20" onFocus="this.select();" onBlur=" IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnAdvance="dns2Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');		
		document.write('</tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Domain Name 1&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="host1Split" size="20" maxlength="60" onFocus="this.select();" onBlur=" " value=\'<!--#nk_get VpnAdvance="host1Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');		
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Domain Name 2&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="host2Split" size="20" maxlength="60" onFocus="this.select();" onBlur="" value=\'<!--#nk_get VpnAdvance="host2Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');		
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Domain Name 3&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="host3Split" size="20" maxlength="60" onFocus="this.select();" onBlur=" " value=\'<!--#nk_get VpnAdvance="host3Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');	
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td></td>');
		document.write('<td>');
		document.write('Domain Name 4&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="host4Split" size="20" maxlength="60" onFocus="this.select();" onBlur="" value=\'<!--#nk_get VpnAdvance="host4Split"-->\'>');
		document.write('</td>');
		document.write('<td></td>');	
		document.write('</tr>');
	}
	document.write('</table>');
	PrintEndBlock(hasUnderLine);
}
//=============== End of content ===============*/
</script>
</head>
<body class="mainframe" onLoad="Entryfunction();" onUnload="Leavefunction();" onResize="ChangeBgsize()" style="overflow:hidden">
<script>PrintBackground();</script>
<table width="100%" border="0" cellpadding="0" cellspacing="0">

	<!--#nk_get JavaScript="menu:0"--><script src="menu.js"></script><!--#nk_get JavaScript="menu:1"-->
	<script>
         SetItemInit(foldersTree, 7, 2);		// Set Selected Node
         initializeTree(foldersTree); 			// Draw Menu & Layout
	</script>
		
	<form id="formgtg" name="formgtg" method="post" action="gateway_to_gateway.htm">       
	<input type="hidden" name="page" value="gateway_to_gateway.htm">       
	<input type="hidden" name="wanNumbers" value='<!--#nk_get GetSystemNum="wan_port_num_now"-->'>       
	<input type="hidden" name="submitStatus" value="1">       
	<input type="hidden" name="log_ch" value="0">
	<input type="hidden" name="afterSubmit" value='<!--#nk_get handle_tags="wzAfterSubmit"-->'>       
	<input type="hidden" name="pageStatus" value='<!--#nk_get VpnG2Gtunnel="isEdit"-->'>	   
	<input type="hidden" name="editStatus" value='<!--#nk_get VpnG2Gtunnel="isEdit"-->'>	   
	<input type="hidden" name="areaMark" value='<!--#nk_get handle_tags="AfterOPAdvanced"-->'>       
	<input type="hidden" name="tunnelStatusChange" value="0">	   
	<input type="hidden" name="L_textFQDN" value='<!--#nk_get VpnLswIp="FQDN"-->'>       
	<input type="hidden" name="L_userName" value='<!--#nk_get VpnLswIp="userName"-->'>       
	<input type="hidden" name="L_domainName" value='<!--#nk_get VpnLswIp="domainName"-->'>  
	<input type="hidden" name="ipLSW1" value=''>        
	<input type="hidden" name="ipLSW2" value=''>        
	<input type="hidden" name="ipLSW3" value=''>        
	<input type="hidden" name="ipLSW4" value=''>
	<input type="hidden" name="ipLSG" value='<!--#nk_get NewVpnLsgIp="IP"-->'>   
	<input type="hidden" name="smLSG" value='<!--#nk_get NewVpnLsgIp="Mask"-->'>          
	<input type="hidden" name="ipLSGbegin" value='<!--#nk_get NewVpnLsgIp="Begin"-->'> 
	<input type="hidden" name="ipLSGend" value='<!--#nk_get NewVpnLsgIp="End"-->'> 
	<input type="hidden" name="ipRSW" value='<!--#nk_get NewVpnRswIp="A"-->'>
	<input type="hidden" name="ipRSW1" value='<!--#nk_get NewVpnRswIp="DnsResolve"-->'>              
	<input type="hidden" name="R_textFQDN" value='<!--#nk_get VpnRswIp="FQDN"-->'>       
	<input type="hidden" name="R_userName" value='<!--#nk_get VpnRswIp="userName"-->'>       
	<input type="hidden" name="R_domainName" value='<!--#nk_get VpnRswIp="domainName"-->'>  
	<input type="hidden" name="ipRSG" value='<!--#nk_get NewVpnRsgIp="IP"-->'>      
	<input type="hidden" name="smRSG" value='<!--#nk_get NewVpnRsgIp="Mask"-->'>      
	<input type="hidden" name="ipRSGbegin" value='<!--#nk_get NewVpnRsgIp="Begin"-->'>
	<input type="hidden" name="ipRSGend" value='<!--#nk_get NewVpnRsgIp="End"-->'>       
	<input type="hidden" name="typeKeyMode" value='<!--#nk_get VpnIPSecSetting="typeKeyMode"-->'>
	<input type="hidden" name="selectdh" value='<!--#nk_get VpnIPSecSetting="select"-->'>      
	<input type="hidden" name="select2" value='<!--#nk_get VpnIPSecSetting="select2"-->'>      
	<input type="hidden" name="select3" value='<!--#nk_get VpnIPSecSetting="select3"-->'>      
	<input type="hidden" name="select4" value='<!--#nk_get VpnIPSecSetting="select4"-->'>      
	<input type="hidden" name="select5" value='<!--#nk_get VpnIPSecSetting="select5"-->'>      
	<input type="hidden" name="typehase2A" value='<!--#nk_get VpnIPSecSetting="typehase2A"-->'>      
	<input type="hidden" name="PFSp" value='<!--#nk_get G2GtypePFSp=""-->'>
	<input type="hidden" name="lifetimeSA1" value='<!--#nk_get VpnIPSecSetting="LifetimeSA1"-->'>      
	<input type="hidden" name="lifetimeSA2" value='<!--#nk_get VpnIPSecSetting="Lifetime"-->'>      
	<input type="hidden" name="keyPreshared2" value='<!--#nk_get VpnIPSecSetting="PreshareKey"-->'>      
	<input type="hidden" name="inSPI"  value='<!--#nk_get VpnIPSecSetting="M_inSPI"-->'>       
	<input type="hidden" name="outSPI" value='<!--#nk_get VpnIPSecSetting="M_outSPI"-->'>       
	<input type="hidden" name="typeEncryption" value='<!--#nk_get VpnIPSecSetting="M_typeEnc"-->'>       
	<input type="hidden" name="typeAuthentication" value='<!--#nk_get VpnIPSecSetting="M_typeAuth"-->'>       
	<input type="hidden" name="keyEncryption" value='<!--#nk_get VpnIPSecSetting="M_encKey"-->'>       
	<input type="hidden" name="keyAuthentication" value='<!--#nk_get VpnIPSecSetting="M_authKey"-->'>       
	<input type="hidden" name="ahAlg" value='<!--#nk_get VpnIPSecSetting="ahAlg"-->'>       
	<input type="hidden" name="radioDnsResolve" value='<!--#nk_get VpnRswIp="radioDnsResolve"-->'>		
	<input type="hidden" name="DnsResolve" value='<!--#nk_get VpnRswIp="DnsResolve"-->'>		
	<input type="hidden" name="typeRSW" value='<!--#nk_get VpnRswIp="typeRSW"-->'>
	<input type="hidden" name="typeLSW" value='<!--#nk_get VpnLswIp="typeLSW"-->'>
	<input type="hidden" name="typeLSG" value='<!--#nk_get VpnLsgIp="typeLSG"-->'>
	<input type="hidden" name="typeRSG" value='<!--#nk_get VpnRsgIp="typeRSG"-->'>
	<input type="hidden" name="isDMZmode" value='<!--#nk_get DMZModeCheck=""-->'>
	<input type="hidden" name="PkStrength" value='<!--#nk_get VpnIPSecSetting="PkStrength"-->'>	

	<script>PrintContent();</script>
	<script>PrintRight();</script>      
	<script>PrintBottom();</script>   
</table>
</body>
</html>
<!--#nk_get SysLogChange="gateway_to_gateway.htm"-->
<!--#nk_get VpnG2Gtunnel="clearEditNo"-->
