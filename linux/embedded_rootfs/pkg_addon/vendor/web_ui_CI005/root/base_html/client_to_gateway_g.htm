<!--#nk_get NewVpnC2G_G=""-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="Pragma" content="No-Cache">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Web Management</title>
<link type="text/css" rel="stylesheet" href="nk.css">
<!--#nk_get JavaScript="nk:0"--><script src="nk.js"></script><!--#nk_get JavaScript="nk:1"-->
<!--#nk_get JavaScript="lg:0"--><script src="lg.js"></script><!--#nk_get JavaScript="lg:1"-->
<script  language="JavaScript">
/***************************************************/
/*												     */	
/*      		Begin of content's JavaScript function    	    */
/*												    */	
/***************************************************/
function Entryfunction()
{
	if (GetURLParam() == "11")
		document.getElementById("Local Group Setup").scrollIntoView(true);
	else if (GetURLParam() == "12")
		document.getElementById("Remote Client Setup").scrollIntoView(true);
	else if (GetURLParam() == "13")
		document.getElementById("IPSec Setup").scrollIntoView(true);
	else if (GetURLParam() == "14")
		document.getElementById("Advanced").scrollIntoView(true);
	chAfterSubmit();
	<!--#nk_get NewVpnGRPtunnel="Warn"-->
	chStrengthBar();
}
function Leavefunction()
{
	chLeave();
}

function chStrengthBar()
{
	if(document.formctg_g.PresharedKeyStrength)
	{
		if (document.formctg_g.PresharedKeyStrength.checked == true)
		{
			document.getElementById("color_table").style.visibility = "visible";
			document.formctg_g.PkStrength.value ="1";
		}
		else
		{
			document.getElementById("color_table").style.visibility = "hidden";
			document.formctg_g.PkStrength.value ="0";
		}
		PrintColorBar(document.formctg_g.keyPreshared2[1]);
	}	
}

function chAfterSubmit()
{
	var y;
	y=cGroupVPNOk;
	if (document.formctg_g.afterSubmit.value=="1")
	{
		if (!confirm(y))
			window.location.replace("vpn_summary.htm");
		else
			window.location.replace("client_to_gateway_g.htm");	   
	}
	else if (document.formctg_g.afterSubmit.value=="2")
	{
		window.location.replace("vpn_summary.htm");
	}
	if (document.formctg_g.areaMark.value=="1")
		document.location="#1";
}
function falseSubmit(F,n)
{
	if (F.PFSp[1].checked==true)
		F.PFSp[0].value="checked";
	else
		F.PFSp[0].value=""; 

	F.submitStatus.value=0;  
	F.action="client_to_gateway_g.htm"+"#"+n;	
	MM_showHideLayers('AutoNumber15','','hide');  	    
	F.submit();
}
function changeStatus(F)
{
	if (F.tunnelStatus.checked==true)
	{
		F.tunnelStatusChange.value=1;
		F.tunnelStatus.value=1;
	}
	else 
	{
		if (F.editStatus.value=="0")
		{
			alert(aDisableTunnel);
			return;
		}
		F.tunnelStatusChange.value=2;
		F.tunnelStatus.value=0;
	}    
	F.submitStatus.value=0; 
	MM_showHideLayers('AutoNumber15','','hide');  	
	F.submit();
}
function lifetimeCheck(I)
{
	validatenum(I, 86401, 120, aSALifeTimeCheck);
}
function lifetime2Check(I)
{
	validatenum(I, 28801, 120, aSALifeTime2Check);
}
function pageReset()
{
	if (document.formctg_g.pageStatus.value=="1")
	{
		document.formctg_g.submitStatus.value="111";
		MM_showHideLayers('AutoNumber15','','hide');  
		document.formctg_g.submit();
	}
	else
		window.location.replace('client_to_gateway_g.htm');
}
function chDismatch()
{
	if (document.formctg_g.typeLSG[1])
	{        
		if (document.formctg_g.smLSG) 
			document.formctg_g.typeLSG[1].selectedIndex=1;	    
		else if (document.formctg_g.ipLSGend) 
			document.formctg_g.typeLSG[1].selectedIndex=2;
		else 
			document.formctg_g.typeLSG[1].selectedIndex=0;
	}    
	if (document.formctg_g.typeRC)	
	{        
		if (document.formctg_g.ipRSW && document.formctg_g.R_textFQDN[1]) 
			document.formctg_g.typeRC[1].selectedIndex=1;	    
		else if (document.formctg_g.ipRSW1[1] && document.formctg_g.R_userName[1])
			document.formctg_g.typeRC[1].selectedIndex=2;        
		else if (document.formctg_g.ipRSW) 
			document.formctg_g.typeRC[1].selectedIndex=0;	    
		else if (document.formctg_g.R_textFQDN[1]) 
			document.formctg_g.typeRC[1].selectedIndex=3;        
		else if (document.formctg_g.R_userName[1]) 
			document.formctg_g.typeRC[1].selectedIndex=4;
	}	
	if (document.formctg_g.PFSp[1])
	{		    
		if (document.formctg_g.select4[1]) 
			document.formctg_g.PFSp[1].checked=true;	    
		else 
			document.formctg_g.PFSp[1].checked=false;
	}
}
function IPDNSCheck(I)
{
	if (I.form.radioDnsResolve[1])
	{
		if (I.form.radioDnsResolve[1].selectedIndex == 1)
		{
			// no check
		}
		else
		{
			IPCheck(I);
		}
	}
}
function checkKeySize(change)
{ 
	if (document.formctg_g.keyEncryption[1]) if (change=="E") 
		document.formctg_g.keyEncryption[1].value="";
	if (document.formctg_g.keyAuthentication[1]) if (change=="A") 
		document.formctg_g.keyAuthentication[1].value="";
}
function KEYCheck(key,type,I)
{
	var inputLength;
	var formLength;
	var charF;
	var stringInput;
	var stringZero="";

	inputLength=I.value.length;
	if (key=="E")
	{
		for (var i=0; i<inputLength; i++)
		{
			charF=parseInt(I.value.charAt(i),16);
			if (isNaN(charF))
			{
				alert(aEncryptionKeyCheck);
				I.value=I.defaultValue;
				return;
			}	  
		}	
		if (type==0) //16
		{
			formLength=16;
		}
		if (type==1) //48
		{
			formLength=48;
		}
	}

	if (key=="A") 
	{
		for (var i=0; i<inputLength; i++)
		{
			charF=parseInt(I.value.charAt(i),16);
			if (isNaN(charF))
			{
				alert(aAuthenticationKeyCheck);
				I.value=I.defaultValue;
				return;
			}	  
		} 
		if (type==0) //32
		{
			formLength=32;
		}
		if (type==1) //40
		{
			formLength=40;
		}  
	}
	if (inputLength<formLength)
	{
		for (var j=0; j<(formLength-inputLength); j++)
		{
			stringZero+="0";
		}
		stringInput=I.value;
		I.value=stringInput+stringZero;	
	}	
}
function SPICheck(SPI,I)
{
	var stringInput;
	var charF;
	var j=0;
	for (var i=0; i<I.value.length; i++)
	{
		charF=parseInt(I.value.charAt(i),16);
		if (isNaN(charF))
		{
			if (SPI=="I") alert(aIncomeSPIHexCheck);
			if (SPI=="O") alert(aOutgoSPIHexCheck);	  
			I.value=I.defaultValue;
			return;
		}	  
	} 
	while (I.value.charAt(j)=="0") j++;
	stringInput=I.value.substring(j,I.value.length);
	if (stringInput.length<3)
	{
		if (SPI=="I") alert(aIncomeSPICheck);
		if (SPI=="O") alert(aOutgoSPICheck);
		I.value=I.defaultValue;
	}
	else
	{
		I.value=stringInput;
	}  
}
function opAdvanced(I,F)
{
	if (I.value=="1")
	{
		F.action="client_to_gateway_g.htm#13";	
		F.advancedStatus.value="0";
		F.submitStatus.value="11"; 
		//close area
	}
	else  
	{  
		F.action="client_to_gateway_g.htm#14";	
		F.advancedStatus.value="1"; 
		F.submitStatus.value="10"; 
		//open area
	}
	if(F.PFSp[1])  
	{
		if (F.PFSp[1].checked==true)
			F.PFSp[0].value=1; 
		else	 
			F.PFSp[0].value=0;
	}
	MM_showHideLayers('AutoNumber15','','hide'); 
	F.submit();
}
function CancelSubmit(F)
{
	if (F.editStatus.value == 1)
		document.location.href="vpn_summary.htm";	
	else
		document.location.href="client_to_gateway_g.htm";
}
function chSubmit(F)
{
	if (F.typeRC[1])    
	{
		if(document.formctg_g.typeRC[1].value==3 ||document.formctg_g.typeRC[1].value==5)
		{
			var mail_l=F.R_userName[1].value.indexOf("@")
			var mail_r=F.R_domainName[1].value.indexOf("@")
			if (mail_l >= 0 || mail_r >= 0)
			{
				alert(aCheckName);
				return;
			}
		}
	}
	if(document.formctg_g.PresharedKeyStrength)
	{
		if (document.formctg_g.PresharedKeyStrength.checked == true)
		if(count_password_strength(F.keyPreshared2[1].value) < 10)
		{
		  alert("Preshared Key strength is not sufficient. Please change a new Preshared Key.");
		  return;
		}	

		if (document.formctg_g.PresharedKeyStrength.checked == true)
			document.formctg_g.PkStrength.value ="1";
		else
			document.formctg_g.PkStrength.value ="0";			
	}	
	
	if(F.select5[1]&&F.typehase2A[1])  
	if(F.select5[1].value==0&&F.typehase2A[1].value==0)  
	{
		alert(aP2AuthEncthesame);	
		return;    
	}
	if (F.tunnelName.value=="") 
	{
		alert(aTunnelName);
		F.tunnelName.select();
		return;  
	}
	if (F.tunnelStatus.checked==true)
	{
		if (F.typeLSW[1])    
		if ((F.typeLSW[1].selectedIndex==1)||(F.typeLSW[1].selectedIndex==3))    
		{
			if (F.L_textFQDN[1])      
			if (F.L_textFQDN[1].value=="")       
			{
				alert(aDomainName);
				F.L_textFQDN[1].select();
				return;  
			}
		}
		if (F.typeLSW[1])
		if ((F.typeLSW[1].selectedIndex==2)||(F.typeLSW[1].selectedIndex==4)) 
		{
			if (F.L_userName[1]) 
			if (F.L_userName[1].value=="") 
			{	  
				alert(aUserName);
				F.L_userName[1].select();
				return;      
			}
			if (F.L_domainName[1])
			if (F.L_domainName[1].value=="")
			{
				alert(aDomainName);	  
				F.L_domainName[1].select();	
				return;    
			}
		}
		if (F.typeRC[1]) 
		if ((F.typeRC[1].selectedIndex==0))    
		{
			if (F.R_textFQDN[1])      
			if (F.R_textFQDN[1].value=="") 
			{
				alert(aDomainName);	  
				F.R_textFQDN[1].select();
				return;     
			}
		}
		if (F.typeRC[1])    
		if ((F.typeRC[1].selectedIndex==1)||(F.typeRC[1].selectedIndex==2))   
		{
			if (F.R_userName[1])     
			if (F.R_userName[1].value=="")
			{
				alert(aUserName);	  
				F.R_userName[1].select();	
				return;      
			}	
			if (F.R_domainName[1])   
			if (F.R_domainName[1].value=="") 
			{
				alert(aDomainName);
				F.R_domainName[1].select();
				return;      
			}    
		}
		if (F.typeKeyMode[1])
		if (F.typeKeyMode[1].selectedIndex==1)
		{  
			if (F.keyPreshared2[1])
			if (F.keyPreshared2[1].value=="")
			{
				alert(aPresharedKey);	  
				F.keyPreshared2[1].select();	  
				return;      
			}
			if (F.lifetimeSA1[1])
			if (F.lifetimeSA1[1].value=="")  
			{	  
				alert(aP1SALifeTime);
				F.lifetimeSA1[1].select();
				return;    
			}	 
			if (F.lifetimeSA2[1])  
			if (F.lifetimeSA2[1].value=="")   
			{	  
				alert(aP2SALifeTime);
				F.lifetimeSA2[1].select();
				return;
			}
		}
	}
	if(F.ipLSG)
	if(F.ipLSG.value=="")
	{
		alert(aIPRangeLSG);
		F.ipLSG.select();	  
		return;
	}
	if(F.smLSG)
	if(F.smLSG.value=="")
	{
		alert(aIPRangeLSG);
		F.smLSG.select();	  
		return;
	}
	if(F.ipLSGEnd)
	if(F.ipLSGEnd.value=="")
	{
		alert(aIPRangeLSG);
		F.ipLSGEnd.select();	  
		return;
	}
	if(document.formctg_g.typeLSG[1])
	{
		if(document.formctg_g.typeLSG[1].value < 3)
			IPSaver(F.ipLSG,F.ipLSG1[1],F.ipLSG2[1],F.ipLSG3[1],F.ipLSG4[1]);
		if(document.formctg_g.typeLSG[1].value ==2)
			IPSaver(F.smLSG,F.smLSG1[1],F.smLSG2[1],F.smLSG3[1],F.smLSG4[1]);
		else if(document.formctg_g.typeLSG[1].value ==3)
		{
			IPSaver(F.ipLSG,F.ipLSG1[1],F.ipLSG2[1],F.ipLSG3[1],F.ipLSG4[1]);
			IPSaver(F.ipLSGEnd,F.ipLSG1[1],F.ipLSG2[1],F.ipLSG3[1],F.rangeLSG);
		}
	}
	F.submitStatus.value=1;  
	F.log_ch.value=1;
	F.tunnelStatusChange.value=0;
	if(F.aggressiveMode)
		F.aggressiveMode.disabled=false;
	window.status=wSave;	
	MM_showHideLayers('AutoNumber15','','hide');
	F.submit();
}

function count_password_strength(password_string)
{
	 var temp="";   
	 var score=8;
	 
	 if(password_string.length < 8)
	     return score;

	 for(var i=0;i<password_string.length;i++)
	 {			 
		if(password_string.charCodeAt(i) >= 65 && password_string.charCodeAt(i) <=90 )
			temp+="A";
		else if(password_string.charCodeAt(i) >= 97 && password_string.charCodeAt(i) <= 122 )
			temp+="a";
		else if(password_string.charCodeAt(i) >= 48 && password_string.charCodeAt(i) <= 57 )
			temp+="1";
		else
			temp+="#";
	 }
	 score=0;

	 for(i=1;i<temp.length;i++)
	 {
	     if(temp.charCodeAt(i) != temp.charCodeAt(i-1) )
		     score++;		
	 }
     score+=temp.length;
	return score;	
}

function PrintColorBar(password)
{
	var public_vNum;

	if(password)
		public_vNum=count_password_strength(password.value)/2;
	else
		public_vNum=4;
	for (var i=1; i<15;i++)
	{
		var temp = "s"+i;
		
		if (document.formctg_g.PresharedKeyStrength.checked == true)
		{
			if (i <= public_vNum)
				document.getElementById(temp).style.visibility = "visible";
			else 
				document.getElementById(temp).style.visibility = "hidden";	
		}
		else
			document.getElementById(temp).style.visibility = "hidden";
	}
}

//================= End =================*/

/***************************************************/
/*												   */	
/*      			  Begin of content    				   */
/*												   */	
/***************************************************/
var ButtonType = "OkCancel";		// NULL/Refresh/OkCancel/BackOkCancel/ShowTableOkCancel
var Savelink = "chSubmit(document.formctg_g);";
var Cancellink = "CancelSubmit(document.formctg_g)"; 
var helplink ='help_client_to_gateway_g.htm';
var UserName = '<!--#nk_get DisplayOnly="nUser"-->';
var head_width=215;
		
function PrintContent()
{
	PrintBeginContent();
	PrintTunnelEnable(1);
	if (document.formctg_g.tunnelStatus.checked)
	{
		PrintLocalGroupSetup(1);
		PrintRemoteClientSetup(1);
		PrintIPSecSetup(1);
	}
	PrintEndContent();
}

function PrintTunnelEnable(hasUnderLine)
{
	PrintBeginBlock(1, "Add a New Group VPN");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');	
	document.write('<tr>');
	document.write('<td width="'+head_width+'"></td>');
	document.write('<td>');
	document.write('<input type="radio" name="Tunnel_GVPN" value="1" onClick="window.location.replace(\'client_to_gateway_t.htm\')">');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('Tunnel');
	document.write('<img border="0" src="images/_blank.gif" width="40" height="1">');
	document.write('<input type="radio" name="Tunnel_GVPN" value="2" checked>');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');	
	document.write('Group VPN');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Group No. &nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<!--#nk_get VpnGRPtunnel="tNo"-->');
	document.write('<input type="hidden" name="tunnelNo" size="4" maxlength="4" style="background-color: #cccccc" readOnly value=\'<!--#nk_get VpnGRPtunnel="tNo"-->\'>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Tunnel Name&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="text" name="tunnelName" size="20" maxlength="40" onFocus="this.select();" onBlur="sTrim(this);" value=\'<!--#nk_get VpnGRPtunnel="tName"-->\'>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Interface&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	var loop_count;
	var num_wan=parseInt(document.formctg_g.wanNumbers.value)-parseInt(document.formctg_g.isDMZmode.value);
	loop_count=num_wan;
	document.write('<select class="Select" name="select6" style="width:133px">');
	document.write('<option value="1" <!--#nk_get VpnGRPtunnel="tWAN1"-->>WAN1</option>');
	for (i=2; i <= loop_count; i++)
	{
		document.write('<option value="'+i+'" ');
		if(i==2) document.write('<!--#nk_get VpnGRPtunnel="tWAN2"-->');
		else if(i==3) document.write('<!--#nk_get VpnGRPtunnel="tWAN3"-->');
		else if(i==4) document.write('<!--#nk_get VpnGRPtunnel="tWAN4"-->');
		else if(i==5) document.write('<!--#nk_get VpnGRPtunnel="tWAN5"-->');
		else if(i==6) document.write('<!--#nk_get VpnGRPtunnel="tWAN6"-->');
		else if(i==7) document.write('<!--#nk_get VpnGRPtunnel="tWAN7"-->');
		else if(i==8) document.write('<!--#nk_get VpnGRPtunnel="tWAN8"-->');
		document.write('>');
		document.write("WAN"+i);			
		document.write('</option>');
	}
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Enable&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="checkbox" name="tunnelStatus" onClick="changeStatus(this.form)" value="1" <!--#nk_get VpnGRPtunnel="enable"-->>');
	document.write('</td>');
	document.write('</tr>');
	document.write('</table>');
	if (document.formctg_g.tunnelStatus.checked)
		PrintEndBlock(1, 0, 1);
	else
		PrintEndBlock(0);
}
function PrintLocalGroupSetup(hasUnderLine)
{
	PrintBeginBlock(1, "Local Group Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');	
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Local Security Group Type&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeLSG" onChange="falseSubmit(this.form,\'11\')" style="width:133px">');
	document.write('<option value="1" <!--#nk_get GRPtypeLSG="1"-->>IP</option>');
	document.write('<option value="2" <!--#nk_get GRPtypeLSG="2"-->>Subnet</option>');
	document.write('<option value="3" <!--#nk_get GRPtypeLSG="3"-->>IP Range</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	if (document.formctg_g.typeLSG[1].value<3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('IP Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');	
		document.write('<input type="text" name="ipLSG" size="20" maxlength="20" onBlur="IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnLsgIpGRP="AA"-->\'>');
		document.write('<input type="hidden" name="ipLSG1" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG2" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG3" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG4" value=\'0\'>')
		document.write('</td>');
		document.write('</tr>');
	}
	if (document.formctg_g.typeLSG[1].value==2)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Subnet Mask&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="smLSG" size="20" maxlength="20" onBlur="IPCheck(this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnLsgIpGRP="BA"-->\'>');
		document.write('<input type="hidden" name="smLSG1" value=\'0\'>');
		document.write('<input type="hidden" name="smLSG2" value=\'0\'>');
		document.write('<input type="hidden" name="smLSG3" value=\'0\'>');
		document.write('<input type="hidden" name="smLSG4" value=\'0\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	else if(document.formctg_g.typeLSG[1].value==3)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Begin IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" id="ipLSG" name="ipLSG" size="20" maxlength="20" onBlur="IPRangeCheck(this,this.form.ipLSGEnd);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnLsgIpGRP="AA"-->\'>');
		document.write('<input type="hidden" name="ipLSG1" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG2" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG3" value=\'0\'>');
		document.write('<input type="hidden" name="ipLSG4" value=\'0\'>');
		document.write('</td>');
		document.write('</tr>');
		document.write('<tr>');
		document.write('<td>');
		document.write('End IP&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" id="ipLSGEnd" name="ipLSGEnd" size="20" maxlength="20" onBlur="IPRangeCheck(this.form.ipLSG,this);" onKeypress="return Check_User_Input(event)" value=\'<!--#nk_get VpnLsgIpGRP="EA"-->\'>');
		document.write('<input type="hidden" name="ipLSG4" value=\'0\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('</table>');
	PrintEndBlock(hasUnderLine, 0, 1);
}
function PrintRemoteClientSetup(hasUnderLine)
{
	PrintBeginBlock(1, "Remote Client Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Remote Client&nbsp;:&nbsp;');
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typeRC" onChange="falseSubmit(this.form,\'12\')" style="width:232px">');
	document.write('<option value="4" <!--#nk_get GRPtypeRC="4"-->>Domain Name(FQDN)</option>');
	document.write('<option value="5" <!--#nk_get GRPtypeRC="5"-->>Email Address(USER FQDN)</option>');
	document.write('<option value="6" <!--#nk_get GRPtypeRC="6"-->>Microsoft XP/2000 VPN Client</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	if(document.formctg_g.typeRC[1].value==4)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Domain Name&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="R_textFQDN" size="40" maxlength="40" value=\'<!--#nk_get VpnRswIpGRP="FQDN"-->\'>');
		document.write('</td>');
		document.write('</tr>');
	}
	else if(document.formctg_g.typeRC[1].value==5)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Email Address&nbsp;:&nbsp;');
		document.write('</td>');
		document.write('<td>');
		document.write('<input type="text" name="R_userName" size="10" maxlength="20" value=\'<!--#nk_get VpnRswIpGRP="userName"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write(' @ ');
		document.write('<input type="text" name="R_domainName" size="40" maxlength="40" value=\'<!--#nk_get VpnRswIpGRP="domainName"-->\'  onFocus="this.select();" onBlur="sTrim(this);">');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('</table>');
	PrintEndBlock(hasUnderLine, 0, 1);
}
function PrintIPSecSetup(hasUnderLine)
{
	PrintBeginBlock(1, "IPSec Setup");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="'+head_width+'">');
	document.write('Keying Mode&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="hidden" name="typeKeyMode" value="2">');
	document.write('IKE with Preshared key');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 1 DH Group&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="selectdh" style="width:183px">');
	document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="Grp1"-->>Group 1 - 768 bit</option>');
	document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="Grp2"-->>Group 2 - 1024 bit</option>');
	document.write('<option value="3" <!--#nk_get VpnIPSecSettingGRP="Grp5"-->>Group 5 - 1536 bit</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 1 Encryption&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="select2" style="width:182px">');
	document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="Aphase1Des"-->>DES</option>');
	document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="Aphase13Des"-->>3DES</option>');
	document.write('<option value="3" <!--#nk_get VpnIPSecSettingGRP="Aphase1Aes128"-->>AES-128</option>');
	document.write('<option value="4" <!--#nk_get VpnIPSecSettingGRP="Aphase1Aes192"-->>AES-192</option>');
	document.write('<option value="5" <!--#nk_get VpnIPSecSettingGRP="Aphase1Aes256"-->>AES-256</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 1 Authentication&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="select3" style="width:182px">');
	document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="Aphase1Md5"-->>MD5</option>');
	document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="Aphase1Sha1"-->>SHA1</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 1 SA Life Time&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="text" name="lifetimeSA1" size="18" maxlength="10" onFocus="this.select();" onBlur=" lifetimeCheck(this)" value=\'<!--#nk_get VpnIPSecSettingGRP="LifetimeSA1"-->\'>');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('seconds');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Perfect Forward Secrecy&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="checkbox" name="PFSp" onClick="falseSubmit(this.form,\'13\');" value="1" <!--#nk_get G2GtypePFSpGRP=""-->>');
	document.write('</td>');
	document.write('</tr>');
	if (document.formctg_g.PFSp[1].checked==true)
	{
		document.write('<tr>');
		document.write('<td>');
		document.write('Phase 2 DH Group&nbsp;:&nbsp;');	
		document.write('</td>');
		document.write('<td>');
		document.write('<select class="select" name="select4" style="width:183px">');
		document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="2Grp1"-->>Group 1 - 768 bit</option>');
		document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="2Grp2"-->>Group 2 - 1024 bit</option>');
		document.write('<option value="3" <!--#nk_get VpnIPSecSettingGRP="2Grp5"-->>Group 5 - 1536 bit</option>');
		document.write('</select>');
		document.write('</td>');
		document.write('</tr>');
	}
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 2 Encryption&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="select5" style="width:183px">');
	document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="Aphase2Des"-->>DES</option>');
	document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="Aphase23Des"-->>3DES</option>');
	document.write('<option value="3" <!--#nk_get VpnIPSecSettingGRP="Aphase2Aes128"-->>AES-128</option>');
	document.write('<option value="4" <!--#nk_get VpnIPSecSettingGRP="Aphase2Aes192"-->>AES-192</option>');
	document.write('<option value="5" <!--#nk_get VpnIPSecSettingGRP="Aphase2Aes256"-->>AES-256</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 2 Authentication&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<select class="select" name="typehase2A" style="width:183px">');
	document.write('<option value="1" <!--#nk_get VpnIPSecSettingGRP="Aphase2Md5"-->>MD5</option>');
	document.write('<option value="2" <!--#nk_get VpnIPSecSettingGRP="Aphase2Sha1"-->>SHA1</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Phase 2 SA Life Time&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="text" name="lifetimeSA2" size="18" maxlength="10" onFocus="this.select();" onBlur=" lifetimeCheck(this)" value=\'<!--#nk_get VpnIPSecSettingGRP="Lifetime"-->\'>');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');	
	document.write('seconds');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('Preshared Key&nbsp;:&nbsp;');	
	document.write('</td>');
	document.write('<td>');
	document.write('<input type="text" name="keyPreshared2" size="30" maxlength="64" onFocus="this.select();" onBlur="sTrim(this);" onkeyup="PrintColorBar(this);" value=\'<!--#nk_get VpnIPSecSettingGRP="PreshareKey"-->\' >');
	document.write('</td>');
	document.write('</tr>');
	
	document.write('<tr>');	
	document.write('<td>Minimum Preshared Key Complexity&nbsp;:&nbsp;</td>');
	document.write('<td>');
	if(document.formctg_g.PkStrength.value == "0")
	    document.write('<input type="checkbox" name="PresharedKeyStrength" value=1 onClick="chStrengthBar()">');
	else
	    document.write('<input type="checkbox" name="PresharedKeyStrength" value=1 onClick="chStrengthBar()" checked >');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('Enable');
	document.write('</td>');	
	document.write('<td></td>');
	document.write('</tr>');	
	document.write('<tr>');	
	document.write('<td>Preshared Key Strength Meter&nbsp;:&nbsp;</td>');
	document.write('<td>');
	document.write('<table id="color_table" class="meterbg" align="left" border="0" style="'+Tablestyle+'">');
	document.write('<tr>');
	document.write('<td height="18" style="padding-right:0px; padding-bottom:0px;">');
	document.write('<img id="s1" border="1" src="images/red.gif" width="10" height="2" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s2" border="1" src="images/red.gif" width="10" height="3" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s3" border="1" src="images/red.gif" width="10" height="4" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s4" border="1" src="images/red.gif" width="10" height="5" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');	
	document.write('<img id="s5" border="1" src="images/yellow.gif" width="10" height="6" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s6" border="1" src="images/yellow.gif" width="10" height="7" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s7" border="1" src="images/yellow.gif" width="10" height="8" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s8" border="1" src="images/yellow.gif" width="10" height="9" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');	
	document.write('<img id="s9" border="1" src="images/yellow.gif" width="10" height="10" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s10" border="1" src="images/green.gif" width="10" height="11" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s11" border="1" src="images/green.gif" width="10" height="12" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');
	document.write('<img id="s12" border="1" src="images/green.gif" width="10" height="13" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');		
	document.write('<img id="s13" border="1" src="images/green.gif" width="10" height="14" style="visibility:hidden; border-color:#002142">');
	document.write('<img border="0" src="images/_blank.gif" width="2" height="10">');		
	document.write('<img id="s14" border="1" src="images/green.gif" width="10" height="15" style="visibility:hidden; border-color:#002142">');	
	document.write('</td>');
	document.write('</tr>');
	document.write('</table>');	
	document.write('</td>');	
	document.write('<td></td>');
	document.write('</tr>');
	
	document.write('<tr>');
	document.write('<td colspan=2>');
	document.write('<input type="hidden" name="advancedStatus" value=\'<!--#nk_get G2GAdvStatus=""-->\'>');
	if (document.formctg_g.advancedStatus.value == 1)
		PrintSTButton("showNew", "Advanced - ", "opAdvanced(document.formctg_g.advancedStatus,document.formctg_g);");
	else	
		PrintSTButton("showNew", "Advanced + ", "opAdvanced(document.formctg_g.advancedStatus,document.formctg_g);");
	document.write('</td>');
	document.write('</tr>');
	document.write('</table>');
	if(document.formctg_g.advancedStatus.value == 1)
	{
		PrintEndBlock(1, 0, 1);
		PrintAdvanced(0);
	}
	else
		PrintEndBlock(0);
}
function PrintAdvanced(hasUnderLine)
{
	PrintBeginBlock(1, "Advanced");
	document.write('<table class="Setuptable" width="'+NormallLayoutwidth+'" border='+Tableborder+'>');
	document.write('<tr>');
	document.write('<td width="10">');
	document.write('<input type="checkbox" name="aggressiveMode" value="1" checked disabled>');
	document.write('</td>');
	document.write('<td width="'+(head_width-26)+'">');
	document.write('Aggressive Mode');
	document.write('</td>');
	document.write('<td width="300"></td>');
	document.write('<td></td>');	
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="IPComp" value="1" <!--#nk_get VpnAdvance="IPComp"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('Compress (Support IP Payload Compression Protocol(IPComp))');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="keepAlive"  value="1" <!--#nk_get VpnAdvance="keepAlive"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('Keep-Alive');
	document.write('</td>');	
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="ahHash" value="1" <!--#nk_get VpnAdvance="ahHash"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('AH Hash Algorithm');
	document.write('<img border="0" src="images/_blank.gif" width="8" height="1">');
	document.write('<select class="select" name="ahAlg">');
	document.write('<option value="1" <!--#nk_get VpnAdvance="ahAlgMD5"-->>MD5</option>');
	document.write('<option value="2" <!--#nk_get VpnAdvance="ahAlgSHA1"-->>SHA1</option>');
	document.write('</select>');
	document.write('</td>');
	document.write('</tr>');
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="biosBC" value="1" <!--#nk_get VpnAdvance="biosBC"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('NetBIOS Broadcast');
	document.write('</td>');
	document.write('</tr>');		
	document.write('<tr>');
	document.write('<td>');
	document.write('<input type="checkbox" name="NATT" value="1" <!--#nk_get VpnAdvance="NATT"-->>');
	document.write('</td>');
	document.write('<td colspan=3>');
	document.write('NAT Traversal');
	document.write('</td>');
	document.write('</tr>');
	document.write('</table>');
	PrintEndBlock(hasUnderLine);
}
//=============== End of content ===============*/
</script>
</head>
<body class="mainframe" onLoad="Entryfunction();" onUnload="Leavefunction();" onResize="ChangeBgsize()" style="overflow:hidden">
<script>PrintBackground();</script>
<table width="100%" border="0" cellpadding="0" cellspacing="0">

	<!--#nk_get JavaScript="menu:0"--><script src="menu.js"></script><!--#nk_get JavaScript="menu:1"-->
	<script>
         SetItemInit(foldersTree, 7, 3);		// Set Selected Node
         initializeTree(foldersTree); 			// Draw Menu & Layout
	</script>
		
	<form id="formctg_g" name="formctg_g" method="post" action="client_to_gateway_g.htm">		
	<input type="hidden" name="page" value="client_to_gateway_g.htm">	  
	<input type="hidden" name="wanNumbers" value='<!--#nk_get GetSystemNum="wan_port_num_now"-->'>		
	<input type="hidden" name="submitStatus" value="1">		
	<input type="hidden" name="log_ch" value="0">
	<input type="hidden" name="afterSubmit" value='<!--#nk_get handle_tags="wzAfterSubmit"-->'>		
	<input type="hidden" name="pageStatus" value='<!--#nk_get VpnGRPtunnel="isEdit"-->'>		
	<input type="hidden" name="areaMark" value='<!--#nk_get handle_tags="AfterOPAdvanced"-->'>		
	<input type="hidden" name="tunnelStatusChange" value="0">		
	<input type="hidden" name="typeLSW" value='<!--#nk_get VpnLswIp="typeLSW"-->'>		
	<input type="hidden" name="L_textFQDN" value='<!--#nk_get VpnLswIp="FQDN"-->'>		
	<input type="hidden" name="userName" value='<!--#nk_get VpnLswIp="userName"-->'>		
	<input type="hidden" name="L_domainName" value='<!--#nk_get VpnLswIp="domainName"-->'>		
	<input type="hidden" name="typeLSG" value='<!--#nk_get VpnLsgIpGRP="typeLSG"-->'> 		
	<input type="hidden" name="ipLSG1" value='<!--#nk_get VpnLsgIpGRP="A1"-->'> 		
	<input type="hidden" name="ipLSG2" value='<!--#nk_get VpnLsgIpGRP="A2"-->'> 		
	<input type="hidden" name="ipLSG3" value='<!--#nk_get VpnLsgIpGRP="A3"-->'> 		
	<input type="hidden" name="ipLSG4" value='<!--#nk_get VpnLsgIpGRP="A4"-->'> 		
	<input type="hidden" name="smLSG1" value='<!--#nk_get VpnLsgIpGRP="B1"-->'>		
	<input type="hidden" name="smLSG2" value='<!--#nk_get VpnLsgIpGRP="B2"-->'>		
	<input type="hidden" name="smLSG3" value='<!--#nk_get VpnLsgIpGRP="B3"-->'>		
	<input type="hidden" name="smLSG4" value='<!--#nk_get VpnLsgIpGRP="B4"-->'>		
	<input type="hidden" name="rangeLSG" value='<!--#nk_get VpnLsgIpGRP="C4"-->'>		
	<input type="hidden" name="typeRSW" value='<!--#nk_get VpnRswIpGRP="typeRSW"-->'>		
	<input type="hidden" name="ipRSW1" value='<!--#nk_get VpnRswIpGRP="A1"-->'>		
	<input type="hidden" name="ipRSW2" value='<!--#nk_get VpnRswIpGRP="A2"-->'>		
	<input type="hidden" name="ipRSW3" value='<!--#nk_get VpnRswIpGRP="A3"-->'>		
	<input type="hidden" name="ipRSW4" value='<!--#nk_get VpnRswIpGRP="A4"-->'>		
	<input type="hidden" name="R_textFQDN" value='<!--#nk_get VpnRswIpGRP="FQDN"-->'>		
	<input type="hidden" name="R_userName" value='<!--#nk_get VpnRswIpGRP="userName"-->'>		
	<input type="hidden" name="R_domainName" value='<!--#nk_get VpnRswIpGRP="domainName"-->'>		
	<input type="hidden" name="typeKeyMode" value='<!--#nk_get VpnIPSecSettingGRP="typeKeyMode"-->'>		
	<input type="hidden" name="selectdh" value='<!--#nk_get VpnIPSecSettingGRP="select"-->'>		
	<input type="hidden" name="select2" value='<!--#nk_get VpnIPSecSettingGRP="select2"-->'>		
	<input type="hidden" name="select3" value='<!--#nk_get VpnIPSecSettingGRP="select3"-->'>		
	<input type="hidden" name="select4" value='<!--#nk_get VpnIPSecSettingGRP="select4"-->'>		
	<input type="hidden" name="select5" value='<!--#nk_get VpnIPSecSettingGRP="select5"-->'>		
	<input type="hidden" name="typehase2A" value='<!--#nk_get VpnIPSecSettingGRP="typehase2A"-->'>		
	<input type="hidden" name="PFSp" value='<!--#nk_get G2GtypePFSp=""-->'>		
	<input type="hidden" name="lifetimeSA1" value='<!--#nk_get VpnIPSecSettingGRP="LifetimeSA1"-->'>		
	<input type="hidden" name="lifetimeSA2" value='<!--#nk_get VpnIPSecSettingGRP="Lifetime"-->'> 		
	<input type="hidden" name="keyPreshared2" value='<!--#nk_get VpnIPSecSettingGRP="PreshareKey"-->'> 		
	<input type="hidden" name="inSPI"  value='<!--#nk_get VpnIPSecSettingGRP="M_inSPI"-->'>		
	<input type="hidden" name="outSPI" value='<!--#nk_get VpnIPSecSettingGRP="M_outSPI"-->'>		
	<input type="hidden" name="typeEncryption" value='<!--#nk_get VpnIPSecSettingGRP="M_typeEnc"-->'>		
	<input type="hidden" name="typeAuthentication" value='<!--#nk_get VpnIPSecSettingGRP="M_typeAuth"-->'>		
	<input type="hidden" name="keyEncryption" value='<!--#nk_get VpnIPSecSettingGRP="M_encKey"-->'>		
	<input type="hidden" name="keyAuthentication" value='<!--#nk_get VpnIPSecSettingGRP="M_authKey"-->'>		
	<input type="hidden" name="ahAlg" value='<!--#nk_get VpnIPSecSettingGRP="ahAlg"-->'>		
	<input type="hidden" name="radioDnsResolve" value='<!--#nk_get VpnRswIpGRP="radioDnsResolve"-->'>		
	<input type="hidden" name="DnsResolve" value='<!--#nk_get VpnRswIpGRP="DnsResolve"-->'>		
	<input type="hidden" name="typeRC" value='<!--#nk_get VpnRswIpGRP="typeRC"-->'>		
	<input type="hidden" name="domainName1" value='<!--#nk_get GrpVpnRC="FQDN"-->'>		
	<input type="hidden" name="editStatus" value='<!--#nk_get VpnGRPtunnel="isEdit"-->'>
	<input type="hidden" name="isDMZmode" value='<!--#nk_get DMZModeCheck=""-->'>
	<input type="hidden" name="PkStrength" value='<!--#nk_get VpnIPSecSettingGRP="PkStrength"-->'>	

	<script>PrintContent();</script>
	<script>PrintRight();</script>      
	<script>PrintBottom();</script>   
</table>
</body>
</html>
<!--#nk_get SysLogChange="client_to_gateway_g.htm"-->
